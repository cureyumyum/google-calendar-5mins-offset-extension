# Google Calendar 5-Minute Start Offset

これは、Googleカレンダーの予定作成を効率化するための非公式Chrome拡張機能です。

カレンダーのグリッド（例: 12:00）をクリックして予定を作成する際、予定の開始時刻が「00分」または「30分」だった場合に、自動的に**開始時刻を5分（例: 12:00 → 12:05）ずらします。
さらに、Googleカレンダーによって自動変更された終了時刻も元の時刻に復元**（例: 12:35 → 12:30）し、25分や50分の予定枠を簡単に作成できるようにします。

---

## 概要

### 課題

Googleカレンダーで新規予定を作成する際、クリックした時間（例: 12:00）がそのまま開始時刻になります。しかし、会議を「5分遅れ」（例: 12:05）で開始し、かつ「25分枠」（例: 12:05〜12:30）で運用する場合、手動で開始時刻と終了時刻の両方を修正する必要があり、非効率でした。

### 解決策

この拡張機能は、ミニポップアップが開かれた際に、以下の条件で時刻を自動的に変更します。

1. **開始時刻のオフセット:**
    - `12:00` → `12:05`
    - `12:30` → `12:35`
2. **終了時刻の自動復元:**
    - Googleカレンダーが開始時刻の変更に反応し、終了時刻を自動でずらしても（例: 12:30 → 12:35）、即座に元の終了時刻（`12:30`）に書き戻します。

これにより、Googleカレンダー側の「会議の迅速化」設定がオフの場合でも、手動操作なしで「12:05〜12:30」のような25分枠の予定を作成できます。

---

## 🛠️ インストール方法

この拡張機能はChromeウェブストアで公開されていません。以下の手順で「デベロッパーモード」で手動インストールする必要があります。

1. **ファイルの準備**
このリポジトリ（または提供されたファイル）をダウンロードし、PC上の任意の場所（例: `C:\Users\YourName\Documents\google-calendar-offset`）に保存します。
フォルダ内には `manifest.json` と `content.js` の2つのファイルがある状態にします。

```
    google-calendar-5mins-offset-extension/
    ├── manifest.json
    └── content.js
```
    
2. **Chrome拡張機能ページを開く**
Chromeのアドレスバーに `chrome://extensions` と入力し、Enterキーを押します。
3. **デベロッパーモードをON**
ページの右上にある「**デベロッパー モード**」のトグルスイッチをONにします。
4. **拡張機能を読み込む**
左上に「**パッケージ化されていない拡張機能を読み込む**」というボタンが表示されるので、それをクリックします。
5. **フォルダの選択**
ファイル選択ダイアログが開くので、ステップ1で準備した**フォルダ（`google-calendar-5mins-offset-extension`）そのもの**を選択し、「フォルダの選択」ボタンを押します。
6. **インストール完了**
拡張機能の一覧に「Google Calendar 5-min Offset (Popup)」というカードが追加されれば、インストールは完了です。

---

## 🚀 使い方

1. インストール後、Googleカレンダーのタブ（`calendar.google.com`）が既に開いている場合は、<b>ページを再読み込み（リロード）</b>してください。
2. **通常動作（オフセット実行）**
    - カレンダー上の「00分」または「30分」の欄（例: 14:00）を**普通にクリック**します。
    - ミニポップアップが開いた直後、開始時刻が「14:05」に、終了時刻が「14:30」に自動変更されることを確認します。
3. **無効化（オフセットしない）**
    - **`Alt`キー**（Macの場合は **`Option`キー**）を**押しながら**、カレンダー上の「00分」または「30分」の欄（例: 15:00）をクリックします。
    - この拡張機能の動作がスキップされ、開始時刻が「15:00」、終了時刻が「15:30」のまま変更されないことを確認します。

---

## ⚠️ 注意点・既知の問題

- **UI依存 (最重要):** この拡張機能はGoogleカレンダーのHTML構造（具体的には `aria-label` 属性）に強く依存しています。Google側でUIの大幅なデザイン変更があった場合、即座に動作しなくなる可能性があります。
- **言語依存:** このスクリプトは、特定の言語の `aria-label` を探します。現在は以下のUI言語に対応しています。
    - **日本語:** `aria-label="開始時間"`, `aria-label="終了時間"`, `aria-label="タイトルを追加"`
    - **英 語:** `aria-label="Start time"`, `aria-label="End time"`, `aria-label="Add title"`
    - もし上記以外の言語（例: ドイツ語、フランス語）でGoogleカレンダーを設定している場合、この拡張機能は動作しません。（`content.js` 内のセレクタ文字列を、その言語の `aria-label` に修正する必要があります）
- **タイミング:** このスクリプトは `setTimeout`（遅延処理）を多用して、Googleカレンダー（React）の再描画タイミングと競合しないように調整されています。PCの処理速度やネットワーク環境によっては、タイミングがずれて稀に動作しない可能性があります。